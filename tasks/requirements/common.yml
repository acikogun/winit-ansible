---
- name: Install pip and virtualenv, enable pip bash completion
  block:
    - name: Upgrade pip
      pip:
        name: pip
        executable: pip3
        extra_args: --upgrade

    - name: Install virtualenv and IPython
      pip:
        name:
          - virtualenv
          - ipython
        executable: pip3
        extra_args: --upgrade

    - name: Enable pip bash completion
      lineinfile:
        create: true
        line: "source <(pip completion --bash)"
        dest: '{{ requirements.pip_config.bash_comp_dest }}'
